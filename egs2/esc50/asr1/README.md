# ESC-50 Audio Classification Recipe

This recipe implements the audio classification task with a BEATs encoder and linear layer decoder model on the ESC-50 dataset, very close to what is described in [this paper](https://arxiv.org/abs/2212.09058).
More specifically, we provide the fine-tuning config and results for second last row in Table 1 (BEATS-iter3) from the paper.
We reuse part of the code from the [BEATs repository](https://github.com/microsoft/unilm/tree/master/beats) for this implementation.

# Training Details and Requirements
We perform 5-fold cross validation as is usually done on ESC-50 dataset.
This dataset has 2k samples with 400 samples in each fold.
Fine-tuning needs 1 GPU with 16 GB memory and runs for ~8 hours.
Although the models converge much earlier ~2-3 hours but we re-use the hyper-parameters from the BEATs paper.
This might be improved in a later version to cut down on training time.


### Steps to run

1. Download ESC-50 dataset from [this repo](https://github.com/karolpiczak/ESC-50?tab=readme-ov-file#download) and set the path to its root directory in db.sh.
2. Download the BEATs checkpoint: [BEATs_iter3](https://github.com/microsoft/unilm/tree/master/beats) and change the `beats_ckpt_path` path in `conf/beats_classification.yaml`
3. Launch with `run_5fold.sh`


## Trained checkpoints
# [TODO - upload checkpoint with better results]

Fine-tuned models:
Fold-1:
Fold-2:
Fold-3:
Fold-4:
Fold-5:


<!-- Generated by scripts/utils/show_asr_result.sh -->
# RESULTS

Average Acc. 93.8%

## Environments
- date: `Tue Dec 10 11:18:39 EST 2024`
- python version: `3.9.20 (main, Oct  3 2024, 07:27:41)  [GCC 11.2.0]`
- espnet version: `espnet 202412`
- pytorch version: `pytorch 2.4.0`
- Git hash: `fa5f449c31438b3659a62e07f99435ff5648217b`
  - Commit date: `Mon Dec 9 21:51:01 2024 -0500`

## exp/asr_fold1/inference_ctc_weight0.0_maxlenratio-1_asr_model_valid.acc.best
### WER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val1|400|400|93.5|6.5|0.0|0.0|6.5|6.5|

### CER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val1|400|5520|99.4|0.6|0.1|0.1|0.7|6.5|


<!-- Generated by scripts/utils/show_asr_result.sh -->
# RESULTS
## Environments
- date: `Tue Dec 10 11:18:21 EST 2024`
- python version: `3.9.20 (main, Oct  3 2024, 07:27:41)  [GCC 11.2.0]`
- espnet version: `espnet 202412`
- pytorch version: `pytorch 2.4.0`
- Git hash: `fa5f449c31438b3659a62e07f99435ff5648217b`
  - Commit date: `Mon Dec 9 21:51:01 2024 -0500`

## exp/asr_fold2/inference_ctc_weight0.0_maxlenratio-1_asr_model_valid.acc.best
### WER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val2|400|400|95.3|4.8|0.0|0.0|4.8|4.8|

### CER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val2|400|5520|99.5|0.5|0.0|0.0|0.5|4.8|


<!-- Generated by scripts/utils/show_asr_result.sh -->

## Environments
- date: `Tue Dec 10 11:18:59 EST 2024`
- python version: `3.9.20 (main, Oct  3 2024, 07:27:41)  [GCC 11.2.0]`
- espnet version: `espnet 202412`
- pytorch version: `pytorch 2.4.0`
- Git hash: `fa5f449c31438b3659a62e07f99435ff5648217b`
  - Commit date: `Mon Dec 9 21:51:01 2024 -0500`

## exp/asr_fold3/inference_ctc_weight0.0_maxlenratio-1_asr_model_valid.acc.best
### WER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val3|400|400|94.0|6.0|0.0|0.0|6.0|6.0|

### CER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val3|400|5520|99.4|0.6|0.0|0.1|0.7|6.0|


<!-- Generated by scripts/utils/show_asr_result.sh -->

## Environments
- date: `Tue Dec 10 11:18:55 EST 2024`
- python version: `3.9.20 (main, Oct  3 2024, 07:27:41)  [GCC 11.2.0]`
- espnet version: `espnet 202412`
- pytorch version: `pytorch 2.4.0`
- Git hash: `fa5f449c31438b3659a62e07f99435ff5648217b`
  - Commit date: `Mon Dec 9 21:51:01 2024 -0500`

## exp/asr_fold4/inference_ctc_weight0.0_maxlenratio-1_asr_model_valid.acc.best
### WER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val4|400|400|95.5|4.5|0.0|0.0|4.5|4.5|

### CER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val4|400|5520|99.5|0.5|0.0|0.0|0.5|4.5|


<!-- Generated by scripts/utils/show_asr_result.sh -->

## Environments
- date: `Tue Dec 10 11:18:54 EST 2024`
- python version: `3.9.20 (main, Oct  3 2024, 07:27:41)  [GCC 11.2.0]`
- espnet version: `espnet 202412`
- pytorch version: `pytorch 2.4.0`
- Git hash: `fa5f449c31438b3659a62e07f99435ff5648217b`
  - Commit date: `Mon Dec 9 21:51:01 2024 -0500`

## exp/asr_fold5/inference_ctc_weight0.0_maxlenratio-1_asr_model_valid.acc.best
### WER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val5|400|400|90.8|9.3|0.0|0.0|9.3|9.3|

### CER

|dataset|Snt|Wrd|Corr|Sub|Del|Ins|Err|S.Err|
|---|---|---|---|---|---|---|---|---|
|org/val5|400|5520|99.1|0.9|0.1|0.0|1.0|9.3|
